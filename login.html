<html>
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.7.9/angular.min.js"></script>
    <script>
      var app = angular.module("authApp", []);

      app.controller("authCtrl", function ($scope, $rootScope) {
        $scope.credentials = [];

        // Function to save the user's credentials to the JSON file
        const saveCredentials = (credentials) => {
          const fs = require("fs");
          const file = "./credentials.json";
          fs.writeFileSync(file, JSON.stringify(credentials));
        };

        // Function to retrieve the user's credentials from the JSON file
        const getCredentials = () => {
          const fs = require("fs");
          const file = "./credentials.json";
          try {
            return JSON.parse(fs.readFileSync(file));
          } catch (error) {
            return [];
          }
        };

        // Function to add a new user's credentials to the JSON file
        $scope.addCredentials = (username, password) => {
          $scope.credentials = getCredentials();
          $scope.credentials.push({ username: username, password: password });
          saveCredentials($scope.credentials);
        };

        // Function to find an existing user's credentials in the JSON file
        $scope.findCredentials = (username, password) => {
          $scope.credentials = getCredentials();
          return $scope.credentials.find(
            (credential) =>
              credential.username === username &&
              credential.password === password
          );
        };

        // Function to handle the login form submission
        $scope.login = () => {
          const credentials = $scope.findCredentials(
            $scope.username,
            $scope.password
          );
          if (credentials) {
            $rootScope.isLoggedIn = true;
            $scope.message = "Login successful";
          } else {
            $scope.message = "Login failed";
          }
        };

        // Function to handle the sign up form submission
        $scope.signup = () => {
          const credentials = $scope.findCredentials(
            $scope.newUsername,
            $scope.newPassword
          );
          if (!credentials) {
            $scope.addCredentials($scope.newUsername, $scope.newPassword);
            $scope.message = "Sign up successful";
          } else {
            $scope.message = "Username already exists";
          }
        };
      });
    </script>
  </head>
  <body ng-app="authApp">
    <div ng-controller="authCtrl">
      <h3>Login</h3>
      <form>
        <label>Username:</label>
        <input type="text" ng-model="username" required>
        <br>
        <label>Password:</lables>
                <input type="password" ng-model="password" required>
        <br><br>
        <button ng-click="login()">Login</button>
      </form>
      <br>
      <h3>Sign Up</h3>
      <form>
        <label>Username:</label>
        <input type="text" ng-model="newUsername" required>
        <br>
        <label>Password:</label>
        <input type="password" ng-model="newPassword" required>
        <br><br>
        <button ng-click="signup()">Sign Up</button>
      </form>
      <br>
      <p>{{message}}</p>
    </div>
  </body>
</html>
